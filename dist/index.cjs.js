"use strict";function e(e,t,i,r){return new(i||(i=Promise))((function(s,o){function n(e){try{u(r.next(e))}catch(e){o(e)}}function l(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,l)}u((r=r.apply(e,t||[])).next())}))}Object.defineProperty(exports,"__esModule",{value:!0}),"function"==typeof SuppressedError&&SuppressedError;class t{constructor(e,t){var i,r,s;this.name=null!==(i=e.name)&&void 0!==i?i:"root",this.isFile=null!==(r=e.isFile)&&void 0!==r&&r,this.id=null!==(s=e.id)&&void 0!==s?s:"",this.parent=t,this.size=0,e.isFile?e.file((e=>{this.file=e,this.size=e.size,this.parent&&this.parent.updateSize(e.size)})):(this.children=[],this.fileCount=0)}addChild(e){this.children.push(e),e.isFile&&this.updateFileCount()}updateSize(e){this.size=this.size+e,this.parent&&this.parent.updateSize(e)}updateFileCount(){this.fileCount++,this.parent&&this.parent.updateFileCount()}getFiles(){return this.isFile?[this]:this.children.reduce(((e,t)=>e.concat(t.getFiles())),[])}}class i{constructor(e){this.root=new t({name:"root",id:e},null),this.fileCount=0}addNode(e){const i=new t(e,this.root);return this.root.addChild(i),i}processNode(e){let t=this.addNode(e);return e.isDirectory?this.parseDirectory(e,t):(this.fileCount++,Promise.resolve())}parseDirectory(e,i){return new Promise(((r,s)=>{e.createReader().readEntries((e=>{const o=e.map((e=>{const r=new t(e,i);return i.addChild(r),e.isDirectory?this.parseDirectory(e,r):(this.fileCount++,Promise.resolve())}));Promise.all(o).then((()=>r())).catch(s)}))}))}getFiles(){return this.root.getFiles()}}exports.constructDirectoryNodeList=(t,r)=>e(void 0,void 0,void 0,(function*(){const e=new i(r),s=Array.from(t).map((t=>{const i=t.webkitGetAsEntry();if(i)return e.processNode(i)}));return yield Promise.all(s),e}));
//# sourceMappingURL=index.cjs.js.map
